---
import Logo from '@/components/ui/Logo.astro'
import MenuIcon from '@/components/icons/Menu.astro'
import CloseIcon from '@/components/icons/Close.astro'

const { pathname } = Astro.url

const isActive = (path: string) => pathname === path

const navLinks = [
  { href: '/', label: 'Inicio' },
  { href: '/transparencia', label: 'Transparencia' },
  { href: '/ofertas', label: 'Ofertas' },
  { href: '/contactos', label: 'Contactos' },
  { href: '/galeria', label: 'Galería' },
]
---

<header
  class="bg-primary border-accent fixed top-0 z-50 w-full border-b-2 text-white shadow-md"
>
  <nav class="mx-auto flex max-w-7xl items-center justify-between px-6 py-4">
    <a href="/" class="flex items-center gap-2 font-bold uppercase">
      <Logo size="sm" />
      <span class="text-lg">La Uemprende</span>
    </a>

    <!-- Desktop Navigation -->
    <div class="hidden gap-8 md:flex">
      {
        navLinks.map(({ href, label }) => (
          <a
            href={href}
            class:list={[
              'group text-sm font-semibold tracking-wide uppercase transition-colors duration-300',
              isActive(href) ? 'text-white' : 'text-secondary hover:text-white',
            ]}
          >
            {label}
            <span
              class:list={[
                'block h-0.5 transition-all duration-300',
                isActive(href)
                  ? 'bg-accent max-w-full'
                  : 'max-w-0 bg-white group-hover:max-w-full',
              ]}
            />
          </a>
        ))
      }
    </div>

    <!-- Mobile Menu Button -->
    <button
      id="menu-toggle"
      class="hover:bg-primary-light rounded-md p-2 transition-colors md:hidden"
      aria-label="Abrir menú"
      aria-expanded="false"
      type="button"
    >
      <span id="menu-icon">
        <MenuIcon />
      </span>
      <span id="close-icon" class="hidden">
        <CloseIcon />
      </span>
    </button>
  </nav>

  <!-- Mobile Navigation -->
  <div
    id="mobile-menu"
    class="bg-primary border-primary-light hidden border-t md:hidden"
  >
    <div class="space-y-1 px-6 py-4">
      {
        navLinks.map(({ href, label }) => (
          <a
            href={href}
            class:list={[
              'block rounded-md px-3 py-2.5 text-base font-semibold tracking-wide uppercase transition-colors duration-200',
              isActive(href)
                ? 'bg-primary-light text-white'
                : 'hover:bg-primary-light text-secondary hover:text-white',
            ]}
          >
            {label}
          </a>
        ))
      }
    </div>
  </div>
</header>

<script>
  const toggle = document.getElementById('menu-toggle')
  const mobileMenu = document.getElementById('mobile-menu')
  const menuIcon = document.getElementById('menu-icon')
  const closeIcon = document.getElementById('close-icon')

  if (toggle && mobileMenu && menuIcon && closeIcon) {
    toggle.addEventListener('click', () => {
      const isExpanded = toggle.getAttribute('aria-expanded') === 'true'

      toggle.setAttribute('aria-expanded', String(!isExpanded))
      mobileMenu.classList.toggle('hidden')
      menuIcon.classList.toggle('hidden')
      closeIcon.classList.toggle('hidden')
    })
  }
</script>
